<!DOCTYPE html><html lang="en" dir="ltr" prefix="content: http://purl.org/rss/1.0/modules/content/ dc: http://purl.org/dc/terms/ foaf: http://xmlns.com/foaf/0.1/ og: http://ogp.me/ns# rdfs: http://www.w3.org/2000/01/rdf-schema# sioc: http://rdfs.org/sioc/ns# sioct: http://rdfs.org/sioc/types# skos: http://www.w3.org/2004/02/skos/core# xsd: http://www.w3.org/2001/XMLSchema#"><head>
  <title>Chef: Community Cookbook Issues | Home</title>
  <link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/bootstrap/3.0.2/css/bootstrap.min.css" media="all">

</head>

<body role="document" class="html not-front not-logged-in one-sidebar sidebar-first page-node page-node- ">
  <div class="main-container container">
    <header role="banner" id="page-header">
      <div class="region region-header">
        <section id="block-block-1" class="block block-block clearfix">
          <p>
            <img alt="" src="../../8f9db5c7.gif" style="height: 42px; width: 250px"><img alt="" src="../../72e006b3.jpg" style="height: 42px; width: 43px"><a href="/content/dev-offerings"><img alt="" src="../../564246f8.jpg"></a><a href="/content/ops-offerings"><img alt="" src="../../ade42a0d.jpg"></a><a href="/content/df.lab"><img alt="" src="../../b5e96cb2.jpg"></a><a href="/content/unicorn-gap"><img alt="" src="../../4ff4a84f.jpg" style="border-style: solid; border-width: 0px"></a>
          </p>
        </section>
      </div>
    </header>
    <!-- /#page-header -->

    <div class="row">
      <aside class="col-sm-3" role="complementary">
        <div class="region region-sidebar-first well">
          <section id="block-system-navigation" class="block block-system block-menu clearfix">
            <h2 class="block-title">pre2015 Content</h2>

            <ul class="menu nav">
              <li class="first leaf">
                <a href="/content/jeff-on-ops-blog" title="">2014 Jeff on Ops Blog</a>
              </li>
              <li class="last leaf">
                <a href="/content/wins-and-losses" title="">Wins &amp; Losses 2000-2014</a>
              </li>
            </ul>
            <h2 class="block-title">Back</h2>

            <ul class="menu nav">
              <li class="first leaf">
                <a href="/pre2015/" title="">Back to pre2015 Home</a>
              </li>
              <li class="last leaf">
                <a href="/" title="">dataFundamentals.com Home</a>
              </li>
            </ul>
          </section>
        </div>
      </aside>

      <section class="col-sm-9">
        <a id="main-content"></a>
        <h1 class="page-header">Chef: Community Cookbook Issues</h1>
        <article id="node-7" class="node node-jeff-on-ops-blog-article clearfix" about="/content/chef-community-cookbook-issues" typeof="sioc:Item foaf:Document">
          <header>
            <span property="dc:title" content="Chef: Community Cookbook Issues" class="rdf-meta element-hidden"></span>
            <span class="submitted">
              <div class="user-picture">
                <img typeof="foaf:Image" class="img-responsive" src="../../e038cf7b.jpg" alt="Jeff Carapetyan's picture" title="Jeff Carapetyan's picture">
              </div>
              <span property="dc:date dc:created" content="2014-04-15T16:39:11-05:00" datatype="xsd:dateTime" rel="sioc:has_creator">Submitted by <span class="username" xml:lang="" about="/users/jeff-carapetyan" typeof="sioc:UserAccount" property="foaf:name" datatype="">Jeff Carapetyan</span> on Tue, 04/15/2014 -
                16:39</span>
            </span>
          </header>
          <div class="field field-name-body field-type-text-with-summary field-label-hidden">
            <div class="field-items">
              <div class="field-item even" property="content:encoded">
                <pre><em><span style="font-size:9px">This blog is one of a series of blogs on the challenges of learning Chef, ops, and the technical world of IT all in one motion. Jeff Carapetyan is an Ops consultant concentrating on basic Chef work, and is available for contracts in the Austin area.</span></em></pre>
                <h3>I probably shouldn't be starting this.</h3>
                <p>What I am about to introduce is a <strong><em>controversial topic</em></strong>. If given only the
                  prompt "community cookbooks", a room full of Chef users would be able to talk for several hours on the
                  best approaches, stating their opinions on how things should be run.</p>
                <p>For me, where I stand is that <strong><em>community cookbooks are not for me</em></strong>, or not as
                  they currently exist. This position is not where I started out.</p>
                <p>Others may say that they are excellent and an integral part of their workflow. And I don't want to
                  disagree with them as it clearly works for them, just not for me. However, I think that everybody can
                  agree on a couple of issues that do pop up when using them.</p>
                <h3>Credits</h3>
                <p>Much of the thinking that went into this article came from extended conversations involving <a href="http://www.meetup.com/Austin-DevOps/events/77688572/">Matt Ray</a> at our local Austin Chef
                  Meetup.</p>
                <p>Other clarity on this thinking came from <a href="https://www.youtube.com/watch?v=vVsSAKtgOYs">this
                    great talk</a> by Noah Kantrowitz.</p>
                <h3>Cookbooks are highly opinionated in their design</h3>
                <p>Those who are new to Chef probably won't understand the distinction of a library vs. application vs.
                  wrapper cookbook (and some experienced people who don't either. Go <a href="http://blog.vialstudios.com/the-environment-cookbook-pattern/">here</a> for a better
                  understanding), but anybody with about 10 minutes of Chef experience will tell you that no two
                  cookbooks are written alike.</p>
                <p>There are so many options in fact, that it gets tough at first to grasp how you should be writing and
                  debugging a cookbook. None of this matters unless you write a cookbook for everyone. Which means, by
                  definition, that almost everyone would have written it a different way than it got written.</p>
                <h3>A Case of Over-reach</h3>
                <p>In the defense of the cookbooks, it really isn't their fault that they got this way. The goal of a
                  community cookbook is to have one cookbook that does everything you could ever want to do for an
                  application or service. The problem is the degree of difficulty in accomplishing such a thing. What
                  starts as a simple cookbook for one OS very quickly becomes a hydra with every special use-case and OS
                  version that you have to account for. In doing so you have add attribute values and libraries and
                  write custom ruby code well beyond the scope of normal chef, and it makes things far more difficult to
                  understand. This is a problem that has gone away over time, but is one that may appear as the most
                  offensive and egregious.</p>
                <p>Noah Kantrowitz does a fantastic job of defining the challenges of reusable cookbooks in <a href="https://www.youtube.com/watch?v=vVsSAKtgOYs">this great talk</a>. The two biggest takeaways I
                  find in this talk are</p>
                <ol>
                  <li>A good re-usable cookbook is not twice as much work, it is 10 times as much work</li>
                  <li>Good cookbook design is like good code design - it takes a lot of discipline, art, and sticking to
                    well worn patterns.</li>
                </ol>
                <h3>They still require you to know a lot about the stuff you are installing.</h3>
                <p>I know how bad this sounds, but it is an important point. The downside to all these configurable
                  options on version numbers and types and configuration options is that you have to know which ones to
                  tweak to get your version. The "default" settings that come with the cookbook might be dramatically
                  different than what you need. Therefore, you have to know the difference between the two and how to
                  get everything running. For senior level people who are looking for an easy way to set up an nginx
                  server like they have 1000 times before this isn't a big deal, but it still remains a barrier to entry
                  for the entry level people.&nbsp;</p>
                <p>For example, if there are 8 key attribute to configure properly, and 2 of these 8 must be changed in
                  tandem with each other, how would the random user even know that?</p>
                <h3>There are robust cookbooks, but there isn't a way to tell which is which is which</h3>
                <p>Matt Ray comes right out and says it. "Maybe [6?] community cookbooks are really great cookbooks that
                  anyone could and should use. The rest....nah" He then enumerates the ones that fits this rare
                  category. My experience has validated his comments as being correct.</p>
                <p>Matt also prescribes the required solution: Namespacing and versioning. If you only have one hadoop
                  cookbook no one is going to be happy. But if they are namespaced and versioned then there's a better
                  chance that multiples can exist, one of which might fit your use case.</p>
                <p>Matt also speaks of an antipattern - the rating system. A 1-5 rating on a generic hadoop cookbook
                  might be meaningless: Two hadoop cookbooks written for different purposes could both be 5 rated, but
                  only for their intended purpose. Using the other 5 rated cookbook for the wrong use case would make it
                  a 1 for that use case.</p>
                <p>Because of these challenges, the rating system to tell if a cookbook is good or not is almost
                  entirely ignored, and so people usually just go with the most downloaded cookbook of that type. That
                  type of thinking may be ignoring a cookbook which is way better written and easier as well.</p>
                <h3>Sometimes, they don't even work right&nbsp;</h3>
                <p>One thing that I found out quickly was that not all community cookbooks are readily maintained after
                  being created. Someone who reserved the namespace may have written one version and then utterly
                  forgotten about it, making it obsolete and useless. And don't think because it is readily maintained
                  that it is bug free. I have had more than my fair share of issues with some cookbooks not installing
                  properly on a new version (again, looking at you Java).&nbsp;</p>
                <h3>The Future</h3>
                <p>There are a few things coming on the horizon that are making community cookbooks look more promising,
                  but nothing released currently. The first is the introduction of Chef-supermarket, which will address
                  a couple of the major issues.</p>
                <p>The second is that people are realizing community cookbooks are too complicated, they are doing what
                  they &nbsp;can to simplify them properly.</p>
                <p>Bottom line, this is an area which can only get better from here. I'm hoping for great things.</p>
                <h3>Here Is What I Do:</h3>
                <ul>
                  <li>I write my own cookbooks. Seems crazy to re-write what others have already done, but my cookbooks
                    are really small and for a very specific use case. Listen at the conferences and you will find that
                    this is very common advice.</li>
                  <li>I always steal ideas and insights from community cookbooks. This is where they really shine. Great
                    stuff.</li>
                  <li>I'm super into testing and versioning and modularizing my cookbooks. Like the <a href="http://en.wikipedia.org/wiki/Unix_philosophy">well worn Unix Philosophy "Only do one thing
                      and do it well"</a>.</li>
                </ul>
                <p>You can see the cookbooks we use here for our internal demos at our <a href="https://github.com/datafundamentals">github site</a>.</p>
              </div>
            </div>
          </div>
          <footer>
          </footer>
        </article>
      </section>

    </div>
  </div>

  <footer class="footer container">
    <div class="region region-footer">
      <section id="block-block-2" class="block block-block clearfix">
        <hr>
        <p class="rtecenter">
          @devopsjeff
          <a href="mailto:pete@datafundamentals.com">pete@datafundamentals.com</a>
          @appwritercom
        </p>
        <hr>
        <p class="rtecenter">Copyright&nbsp;2014, 2015 - dataFundamentals</p>
      </section>
    </div>
  </footer>
  





</body></html>